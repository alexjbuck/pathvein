
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Rich and deep file structure pattern matching">
      
      
      
        <link rel="canonical" href="https://alexjbuck.github.io/pathvein/latest/api/pattern/">
      
      
        <link rel="prev" href="../functions/">
      
      
        <link rel="next" href="../types/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>FileStructurePattern - Pathvein Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#filestructurepattern" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Pathvein Documentation" class="md-header__button md-logo" aria-label="Pathvein Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pathvein Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FileStructurePattern
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/alexjbuck/pathvein" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    alexjbuck/pathvein
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/installation/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guide/patterns/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../about/changelog/" class="md-tabs__link">
          
  
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Pathvein Documentation" class="md-nav__button md-logo" aria-label="Pathvein Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Pathvein Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/alexjbuck/pathvein" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    alexjbuck/pathvein
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/scanning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scanning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/shuffling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Shuffling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    FileStructurePattern
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    FileStructurePattern
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileStructurePattern
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FileStructurePattern">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.all_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.all_directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_directories
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.load_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.from_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.add_directory" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_directory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.add_directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_directories
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.add_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.add_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.set_directory_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_directory_name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.parents_of" class="md-nav__link">
    <span class="md-ellipsis">
      
        parents_of
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.matches" class="md-nav__link">
    <span class="md-ellipsis">
      
        matches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        copy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.threaded_copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        threaded_copy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage Examples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Patterns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nested Patterns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json-serialization" class="md-nav__link">
    <span class="md-ellipsis">
      
        JSON Serialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pattern Matching
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-parent-directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        Finding Parent Directories
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copying-with-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Copying with Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pattern-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pattern Components
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pattern Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#directory_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        directory_name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    <span class="md-ellipsis">
      
        files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        directories
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        optional_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional_directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        optional_directories
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backend
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileStructurePattern
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FileStructurePattern">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.all_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.all_directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_directories
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.load_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.from_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.add_directory" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_directory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.add_directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_directories
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.add_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.add_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.set_directory_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_directory_name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.parents_of" class="md-nav__link">
    <span class="md-ellipsis">
      
        parents_of
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.matches" class="md-nav__link">
    <span class="md-ellipsis">
      
        matches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        copy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathvein.pattern.FileStructurePattern.threaded_copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        threaded_copy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage Examples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Patterns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nested Patterns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json-serialization" class="md-nav__link">
    <span class="md-ellipsis">
      
        JSON Serialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pattern Matching
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-parent-directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        Finding Parent Directories
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copying-with-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Copying with Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pattern-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pattern Components
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pattern Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#directory_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        directory_name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    <span class="md-ellipsis">
      
        files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        directories
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        optional_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional_directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        optional_directories
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="filestructurepattern">FileStructurePattern</h1>
<p>The <code>FileStructurePattern</code> class is the core of pathvein's pattern matching system.</p>


<div class="doc doc-object doc-class">



<h2 id="pathvein.pattern.FileStructurePattern" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">pathvein.pattern.FileStructurePattern</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents first">



        <p>A representation of a file structure pattern with required and optional components.</p>
<p>This class also supports a builder pattern as any intermediate state is also valid.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="nd">@dataclass</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="k">class</span><span class="w"> </span><span class="nc">FileStructurePattern</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    A representation of a file structure pattern with required and optional components.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    This class also supports a builder pattern as any intermediate state is also valid.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">directory_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">directories</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Self</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">optional_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">optional_directories</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Self</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__key</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">):</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">directory_name</span><span class="p">,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>            <span class="nb">hash</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)),</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>            <span class="nb">hash</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directories</span><span class="p">)),</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="nb">hash</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optional_files</span><span class="p">)),</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="nb">hash</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optional_directories</span><span class="p">)),</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">):</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">())</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">FileStructurePattern</span><span class="p">):</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="k">return</span> <span class="bp">NotImplemented</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a FileStructurePattern from a JSON file</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            json_path: Path to JSON file containing pattern specification</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            FileStructurePattern instance</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">            FileNotFoundError: If json_path does not exist</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            json.JSONDecodeError: If file contains invalid JSON</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            ValueError: If JSON structure is invalid for pattern specification</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="n">json_str</span> <span class="o">=</span> <span class="n">json_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pattern file not found: </span><span class="si">{</span><span class="n">json_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading pattern file </span><span class="si">{</span><span class="n">json_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">spec_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a FileStructurePattern from a JSON string</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            spec_str: JSON string containing pattern specification</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            FileStructurePattern instance</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            json.JSONDecodeError: If spec_str is not valid JSON</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            ValueError: If JSON structure is invalid for pattern specification</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="n">spec</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">spec_str</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">raise</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">(</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid JSON in pattern specification: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">pos</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                <span class="sa">f</span><span class="s2">&quot;Pattern specification must be a JSON object, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="bp">cls</span><span class="p">()</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                <span class="o">.</span><span class="n">set_directory_name</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directory_name&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">))</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                <span class="o">.</span><span class="n">add_files</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="p">[]))</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                <span class="o">.</span><span class="n">add_files</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;optional_files&quot;</span><span class="p">,</span> <span class="p">[]),</span> <span class="n">is_optional</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                <span class="o">.</span><span class="n">add_directories</span><span class="p">(</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                    <span class="p">(</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                        <span class="bp">cls</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">subdirectory_spec</span><span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                        <span class="k">for</span> <span class="n">subdirectory_spec</span> <span class="ow">in</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directories&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                    <span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                <span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="o">.</span><span class="n">add_directories</span><span class="p">(</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>                    <span class="p">(</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>                        <span class="bp">cls</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">subdirectory_spec</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>                        <span class="k">for</span> <span class="n">subdirectory_spec</span> <span class="ow">in</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;optional_directories&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                    <span class="p">),</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                    <span class="n">is_optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                <span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid pattern specification structure: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="c1"># Deepcopy prevents mutating self during serialization.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="c1"># self__dict__ and dictionary point to the same object otherwise.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">dictionary</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">dictionary</span><span class="p">[</span><span class="s2">&quot;directories&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="n">directory</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">directories</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="p">]</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">dictionary</span><span class="p">[</span><span class="s2">&quot;optional_directories&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="n">directory</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">optional_directories</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="p">]</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        Add a FileStructureRequirement entry to the (optional) directory list</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        This method uses deepcopy to prevent recursive references. This means it supports</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        requirement = FileStructureRequirement()</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        requirement.add_directory(requirement)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        ```</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        This keeps the two requirements as separate objects so as to not create a reference loop.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="k">if</span> <span class="n">is_optional</span><span class="p">:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">optional_directories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">directory</span><span class="p">))</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">directories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">directory</span><span class="p">))</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_directories</span><span class="p">(</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">directories</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Self</span><span class="p">],</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">directories</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">add_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_file</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">if</span> <span class="n">is_optional</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">optional_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_files</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_directory_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">directory_name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">all_files</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optional_files</span><span class="p">))</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">all_directories</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Self</span><span class="p">]:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directories</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optional_directories</span><span class="p">))</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parents_of</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find all possible parent directories that could contain the given file based on the pattern.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        This method will complete a recursive search through all the required and</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        optional files in the pattern through all directory tree branches.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        Each level constructs the pattern for the optional and required files</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        to include the parents of the current directory pattern and compares that</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        to the full path of the provided file. If the pattern matches then we</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        compute the root directory of the pattern that would contain that file by</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        evaluating the depth of the pattern and backing off that many layers from</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        the input file. That path gets added to a set of possible parent directories.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        Its possible to have multiple possible parent directories at this point of</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        evaluation. As a trivial example imagine a pattern with optional files at</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        **/a/b/file.txt and **/b/file.txt. When provided an input file of:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        /input/a/b/file.txt it will match on both patterns. The two possible parent</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        or root directories are /input and /input/a. Without evaluating the full</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        pattern from that root directory we cannot yet be sure if either is actually</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        a valid parent/root directory. We only have the context of this single input</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        file. From that alone, either directory _could_ be the root with this pattern.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;**/&quot;</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="k">for</span> <span class="n">file_pattern</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_files</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="n">pattern</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">parent</span> <span class="o">/</span> <span class="n">file_pattern</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="c1"># UPath.match doesn&#39;t seem to work reliably, cast to a Path type explicitly</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="c1"># and use its glob-style pattern matching.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="c1"># This turns s3://bucket/prefix into /bucket/prefix so any glob pattern as</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="c1"># the only difference is the absence of the s3:/ protocol prefix.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                <span class="c1"># patterns are ** / &lt;directories&gt; / file</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span class="c1"># so the directory depth is length of parts - 2</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                <span class="c1"># Minus 1 for the ** and minus 1 for the file</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                <span class="c1"># The directory depth is the number of &quot;parents&quot; that we need to go up.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span class="n">depth</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                <span class="n">candidates</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="n">depth</span><span class="p">])</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_directories</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="n">candidates</span> <span class="o">|=</span> <span class="n">directory</span><span class="o">.</span><span class="n">parents_of</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">parent</span> <span class="o">/</span> <span class="n">directory</span><span class="o">.</span><span class="n">directory_name</span><span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="k">return</span> <span class="n">candidates</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">walk_args</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a provided dirpath, dirnames, and filenames set matches the requirements&quot;&quot;&quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="c1"># Unpack Path.walk outputs. Taking this as a tuple simplifies the recursion callsite below</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="o">=</span> <span class="n">walk_args</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">lpad</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="n">depth</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Evaluating match for </span><span class="si">%s</span><span class="s2"> against </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">lpad</span><span class="p">,</span> <span class="n">dirpath</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="c1"># Short circuit check for directory name pattern match</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory_name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">match_pattern</span><span class="p">(</span><span class="n">dirpath</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory_name</span><span class="p">):</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> x Failed match on directory name: Expected: </span><span class="si">%s</span><span class="s2">, Found: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                <span class="n">lpad</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">directory_name</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                <span class="n">dirpath</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="c1"># Short circuit check for required file patterns</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="c1"># If all input filenames do not match a pattern, then its a missed pattern, and not a match</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="c1"># The failing case is when no files match a pattern, aka all files do not match.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="c1">#</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="c1"># NOTE(Performance): Use PatternMatcher to avoid FFI overhead on each filename check</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="c1"># PatternMatcher compiles the pattern once and keeps it in Rust, avoiding repeated FFI calls</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="c1"># Invalid patterns are automatically handled by PatternMatcher (falls back to Python)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">matcher</span> <span class="o">=</span> <span class="n">PatternMatcher</span><span class="p">([</span><span class="n">pattern</span><span class="p">])</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="k">if</span> <span class="n">_none_of</span><span class="p">(</span><span class="n">matcher</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">):</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                    <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> x Failed match on required file pattern. Required </span><span class="si">%s</span><span class="s2">, Found: </span><span class="si">%s</span><span class="s2">, Directory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>                    <span class="n">lpad</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                    <span class="n">pattern</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                    <span class="n">filenames</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                    <span class="n">dirpath</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>                <span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="c1"># NOTE: This could be written as a double nested list comprehension that includes the</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="c1"># self.directories iterations as well, but its rather confusing to read, leaving that</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="c1"># as an outer for-loop is easier to read.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="c1">#</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="c1"># Recurse into required subdirectory branches (if they exist)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="k">for</span> <span class="n">branch_pattern</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">directories</span><span class="p">:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="c1"># Evaluate if any actual directories from dirnames match the given pattern</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="k">if</span> <span class="n">_none_of</span><span class="p">(</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>                <span class="n">branch_pattern</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">iterdir</span><span class="p">(</span><span class="n">dirpath</span> <span class="o">/</span> <span class="n">directory</span><span class="p">),</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>                <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">dirnames</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="p">):</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                    <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> x Failed on subdirectory match. Required </span><span class="si">%s</span><span class="s2">, Found: </span><span class="si">%s</span><span class="s2">, Directory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                    <span class="n">lpad</span><span class="p">,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>                    <span class="n">branch_pattern</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>                    <span class="n">dirnames</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>                    <span class="n">dirpath</span><span class="p">,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>                <span class="p">)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="c1"># Passing all previous checks implies:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="c1"># 1. The directory_name matches or is not a requirement</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="c1"># 2. The required file patterns are matched</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="c1"># 3. The required directories are matched (recursively)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="c1"># In this case, this directory structure meets the requirements!</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> + Matched: </span><span class="si">%s</span><span class="s2"> on </span><span class="si">%s</span><span class="s2">!&quot;</span><span class="p">,</span> <span class="n">lpad</span><span class="p">,</span> <span class="n">dirpath</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="n">source</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">destination</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="n">dryrun</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy all files and folders from inside source that match the file requirements patterns into the destination path.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        Before:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        Source:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        source_dir/</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            file1.txt</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            nested/</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">                file2.txt</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        Destination:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        dest_dir/</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        After:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        Source:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        source_dir/</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">            file1.txt</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">            nested/</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">                file2.txt</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        Destination:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        dest_dir/</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        source_dir/</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">            file1.txt</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">            nested/</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">                file2.txt</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">dryrun_pad</span> <span class="o">=</span> <span class="s2">&quot;(dryrun) &quot;</span> <span class="k">if</span> <span class="n">dryrun</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">dryrun</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="n">destination</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="c1"># Copy all files in this top level that match a required or optional file pattern</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="n">_</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">files</span> <span class="o">=</span> <span class="n">iterdir</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="c1"># Use PatternMatcher for efficient multi-pattern matching</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="n">file_matcher</span> <span class="o">=</span> <span class="n">PatternMatcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_files</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_files</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">source</span> <span class="o">/</span> <span class="n">file</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                <span class="s2">&quot;Checking file against patterns&quot;</span><span class="p">,</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">file</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_files</span><span class="p">},</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="k">if</span> <span class="n">file_matcher</span> <span class="ow">and</span> <span class="n">file_matcher</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found match&quot;</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">dryrun</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Beginning copy&quot;</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                    <span class="n">target</span> <span class="o">=</span> <span class="n">destination</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                    <span class="n">stream_copy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                        <span class="s2">&quot;Copied file&quot;</span><span class="p">,</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                        <span class="n">extra</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>                            <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>                            <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="n">destination</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>                        <span class="p">},</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                    <span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="c1"># Recurse into any directories at this level that match a required or optional directory pattern</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">directories</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">source</span> <span class="o">/</span> <span class="n">directory</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="k">for</span> <span class="n">branch_pattern</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_directories</span><span class="p">:</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>                <span class="k">if</span> <span class="n">branch_pattern</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">iterdir</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>                    <span class="n">branch_pattern</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>                        <span class="n">path</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                        <span class="n">destination</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                        <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                        <span class="n">dryrun</span><span class="o">=</span><span class="n">dryrun</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                    <span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Directory copied&quot;</span><span class="p">,</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="n">dryrun_pad</span><span class="p">,</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="n">extra</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="n">destination</span><span class="p">,</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>                <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="p">},</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">threaded_copy</span><span class="p">(</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="n">source</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="n">destination</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="n">dryrun</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy all files and folders from inside source that match the file requirements patterns into the destination path.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        Before:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        Source:</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        source_dir/</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">            file1.txt</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">            nested/</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">                file2.txt</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        Destination:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        dest_dir/</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        After:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        Source:</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        source_dir/</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">            file1.txt</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            nested/</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">                file2.txt</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        Destination:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        dest_dir/</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        source_dir/</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            file1.txt</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">            nested/</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">                file2.txt</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">futures</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Future</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>  <span class="c1"># Adjust based on your needs</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>            <span class="k">def</span><span class="w"> </span><span class="nf">recursive_scan</span><span class="p">(</span><span class="n">src</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">dest</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span> <span class="n">Self</span> <span class="o">=</span> <span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">dryrun</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                    <span class="n">dest</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                <span class="c1"># Copy all files in this top level that match a required or optional file pattern</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                <span class="n">_</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">files</span> <span class="o">=</span> <span class="n">iterdir</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                <span class="c1"># Use PatternMatcher for efficient multi-pattern matching</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                <span class="n">file_matcher</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                    <span class="n">PatternMatcher</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">all_files</span><span class="p">)</span> <span class="k">if</span> <span class="n">pattern</span><span class="o">.</span><span class="n">all_files</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>                <span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                    <span class="s2">&quot;Beginning copy operation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                    <span class="n">extra</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">src</span><span class="p">,</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                        <span class="s2">&quot;directories&quot;</span><span class="p">:</span> <span class="n">directories</span><span class="p">,</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                        <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="n">files</span><span class="p">,</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                        <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="n">pattern</span><span class="p">,</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                    <span class="p">},</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                <span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>                <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                    <span class="n">path</span> <span class="o">=</span> <span class="n">src</span> <span class="o">/</span> <span class="n">file</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                        <span class="s2">&quot;Checking file against patterns&quot;</span><span class="p">,</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                        <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="n">pattern</span><span class="o">.</span><span class="n">all_files</span><span class="p">},</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                    <span class="p">)</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                    <span class="k">if</span> <span class="n">file_matcher</span> <span class="ow">and</span> <span class="n">file_matcher</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found match&quot;</span><span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">dryrun</span><span class="p">:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>                            <span class="n">target</span> <span class="o">=</span> <span class="n">dest</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>                            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>                                <span class="s2">&quot;Submitting copy task&quot;</span><span class="p">,</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                                <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span> <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">},</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                            <span class="p">)</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                            <span class="n">future</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">stream_copy</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                            <span class="n">futures</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                <span class="c1"># Recurse into any directories at this level that match a required or optional directory pattern</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">directories</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                    <span class="n">path</span> <span class="o">=</span> <span class="n">src</span> <span class="o">/</span> <span class="n">directory</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                    <span class="k">for</span> <span class="n">branch_pattern</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_directories</span><span class="p">:</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                        <span class="k">if</span> <span class="n">branch_pattern</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">iterdir</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                            <span class="n">recursive_scan</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dest</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">branch_pattern</span><span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>            <span class="n">recursive_scan</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Waiting for futures&quot;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">futures</span><span class="p">)})</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="n">done</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">wait</span><span class="p">(</span><span class="n">futures</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                    <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Copy operation failed&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Directory copied&quot;</span><span class="p">,</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="s2">&quot;(dryrun) &quot;</span> <span class="k">if</span> <span class="n">dryrun</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="n">extra</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="n">destination</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>                <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="p">},</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">





<h3 id="pathvein.pattern.FileStructurePattern-attributes">Attributes</h3>

<div class="doc doc-object doc-attribute">



<h4 id="pathvein.pattern.FileStructurePattern.all_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">all_files</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">all_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="pathvein.pattern.FileStructurePattern.all_directories" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">all_directories</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">all_directories</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Self</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<h3 id="pathvein.pattern.FileStructurePattern-functions">Functions</h3>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__init__</span><span class="p">(</span><span class="n">directory_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="n">directories</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Self</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="n">optional_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="n">optional_directories</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Self</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.load_json" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_json</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_json</span><span class="p">(</span><span class="n">json_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a FileStructurePattern from a JSON file</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>json_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to JSON file containing pattern specification</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pathlib.Path">Path</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing_extensions.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>FileStructurePattern instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If json_path does not exist</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="json.JSONDecodeError">JSONDecodeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If file contains invalid JSON</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="ValueError">ValueError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If JSON structure is invalid for pattern specification</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a FileStructurePattern from a JSON file</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        json_path: Path to JSON file containing pattern specification</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        FileStructurePattern instance</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        FileNotFoundError: If json_path does not exist</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        json.JSONDecodeError: If file contains invalid JSON</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        ValueError: If JSON structure is invalid for pattern specification</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">json_str</span> <span class="o">=</span> <span class="n">json_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pattern file not found: </span><span class="si">{</span><span class="n">json_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading pattern file </span><span class="si">{</span><span class="n">json_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.from_json" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">from_json</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">from_json</span><span class="p">(</span><span class="n">spec_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a FileStructurePattern from a JSON string</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spec_str</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>JSON string containing pattern specification</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing_extensions.Self">Self</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>FileStructurePattern instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="json.JSONDecodeError">JSONDecodeError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If spec_str is not valid JSON</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="ValueError">ValueError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If JSON structure is invalid for pattern specification</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">spec_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a FileStructurePattern from a JSON string</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        spec_str: JSON string containing pattern specification</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        FileStructurePattern instance</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        json.JSONDecodeError: If spec_str is not valid JSON</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        ValueError: If JSON structure is invalid for pattern specification</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">spec</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">spec_str</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="k">raise</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">(</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="sa">f</span><span class="s2">&quot;Invalid JSON in pattern specification: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">pos</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="sa">f</span><span class="s2">&quot;Pattern specification must be a JSON object, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="bp">cls</span><span class="p">()</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="o">.</span><span class="n">set_directory_name</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directory_name&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">))</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="o">.</span><span class="n">add_files</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="p">[]))</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="o">.</span><span class="n">add_files</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;optional_files&quot;</span><span class="p">,</span> <span class="p">[]),</span> <span class="n">is_optional</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="o">.</span><span class="n">add_directories</span><span class="p">(</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                <span class="p">(</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                    <span class="bp">cls</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">subdirectory_spec</span><span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                    <span class="k">for</span> <span class="n">subdirectory_spec</span> <span class="ow">in</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directories&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                <span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="o">.</span><span class="n">add_directories</span><span class="p">(</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>                <span class="p">(</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>                    <span class="bp">cls</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">subdirectory_spec</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>                    <span class="k">for</span> <span class="n">subdirectory_spec</span> <span class="ow">in</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;optional_directories&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                <span class="p">),</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                <span class="n">is_optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid pattern specification structure: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.to_json" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">to_json</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">to_json</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="c1"># Deepcopy prevents mutating self during serialization.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="c1"># self__dict__ and dictionary point to the same object otherwise.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">dictionary</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">dictionary</span><span class="p">[</span><span class="s2">&quot;directories&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">directory</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">directories</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="p">]</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">dictionary</span><span class="p">[</span><span class="s2">&quot;optional_directories&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">directory</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">optional_directories</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="p">]</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.add_directory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_directory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">add_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add a FileStructureRequirement entry to the (optional) directory list</p>
<p>This method uses deepcopy to prevent recursive references. This means it supports
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">requirement</span> <span class="o">=</span> <span class="n">FileStructureRequirement</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">requirement</span><span class="o">.</span><span class="n">add_directory</span><span class="p">(</span><span class="n">requirement</span><span class="p">)</span>
</code></pre></div>
This keeps the two requirements as separate objects so as to not create a reference loop.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    Add a FileStructureRequirement entry to the (optional) directory list</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    This method uses deepcopy to prevent recursive references. This means it supports</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    requirement = FileStructureRequirement()</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    requirement.add_directory(requirement)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    ```</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    This keeps the two requirements as separate objects so as to not create a reference loop.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="k">if</span> <span class="n">is_optional</span><span class="p">:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optional_directories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">directory</span><span class="p">))</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">directories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">directory</span><span class="p">))</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.add_directories" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_directories</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">add_directories</span><span class="p">(</span><span class="n">directories</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Self</span><span class="p">],</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_directories</span><span class="p">(</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">directories</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Self</span><span class="p">],</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">directories</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.add_file" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_file</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">add_file</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_file</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">if</span> <span class="n">is_optional</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optional_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.add_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_files</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">add_files</span><span class="p">(</span><span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_files</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">is_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">is_optional</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.set_directory_name" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_directory_name</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">set_directory_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_directory_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">directory_name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.parents_of" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">parents_of</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">parents_of</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Find all possible parent directories that could contain the given file based on the pattern.</p>
<p>This method will complete a recursive search through all the required and
optional files in the pattern through all directory tree branches.</p>
<p>Each level constructs the pattern for the optional and required files
to include the parents of the current directory pattern and compares that
to the full path of the provided file. If the pattern matches then we
compute the root directory of the pattern that would contain that file by
evaluating the depth of the pattern and backing off that many layers from
the input file. That path gets added to a set of possible parent directories.</p>
<p>Its possible to have multiple possible parent directories at this point of
evaluation. As a trivial example imagine a pattern with optional files at
<strong>/a/b/file.txt and </strong>/b/file.txt. When provided an input file of:</p>
<p>/input/a/b/file.txt it will match on both patterns. The two possible parent
or root directories are /input and /input/a. Without evaluating the full
pattern from that root directory we cannot yet be sure if either is actually
a valid parent/root directory. We only have the context of this single input
file. From that alone, either directory <em>could</em> be the root with this pattern.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="k">def</span><span class="w"> </span><span class="nf">parents_of</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find all possible parent directories that could contain the given file based on the pattern.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    This method will complete a recursive search through all the required and</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    optional files in the pattern through all directory tree branches.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    Each level constructs the pattern for the optional and required files</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    to include the parents of the current directory pattern and compares that</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    to the full path of the provided file. If the pattern matches then we</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">    compute the root directory of the pattern that would contain that file by</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    evaluating the depth of the pattern and backing off that many layers from</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    the input file. That path gets added to a set of possible parent directories.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">    Its possible to have multiple possible parent directories at this point of</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    evaluation. As a trivial example imagine a pattern with optional files at</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    **/a/b/file.txt and **/b/file.txt. When provided an input file of:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    /input/a/b/file.txt it will match on both patterns. The two possible parent</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    or root directories are /input and /input/a. Without evaluating the full</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    pattern from that root directory we cannot yet be sure if either is actually</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    a valid parent/root directory. We only have the context of this single input</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    file. From that alone, either directory _could_ be the root with this pattern.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">candidates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;**/&quot;</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">for</span> <span class="n">file_pattern</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_files</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">pattern</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">parent</span> <span class="o">/</span> <span class="n">file_pattern</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="c1"># UPath.match doesn&#39;t seem to work reliably, cast to a Path type explicitly</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="c1"># and use its glob-style pattern matching.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="c1"># This turns s3://bucket/prefix into /bucket/prefix so any glob pattern as</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="c1"># the only difference is the absence of the s3:/ protocol prefix.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="c1"># patterns are ** / &lt;directories&gt; / file</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="c1"># so the directory depth is length of parts - 2</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="c1"># Minus 1 for the ** and minus 1 for the file</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="c1"># The directory depth is the number of &quot;parents&quot; that we need to go up.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="n">depth</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="n">candidates</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="n">depth</span><span class="p">])</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_directories</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">candidates</span> <span class="o">|=</span> <span class="n">directory</span><span class="o">.</span><span class="n">parents_of</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">parent</span> <span class="o">/</span> <span class="n">directory</span><span class="o">.</span><span class="n">directory_name</span><span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="k">return</span> <span class="n">candidates</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.matches" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">matches</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">matches</span><span class="p">(</span><span class="n">walk_args</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a provided dirpath, dirnames, and filenames set matches the requirements</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">walk_args</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a provided dirpath, dirnames, and filenames set matches the requirements&quot;&quot;&quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="c1"># Unpack Path.walk outputs. Taking this as a tuple simplifies the recursion callsite below</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="o">=</span> <span class="n">walk_args</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">lpad</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="n">depth</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Evaluating match for </span><span class="si">%s</span><span class="s2"> against </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">lpad</span><span class="p">,</span> <span class="n">dirpath</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="c1"># Short circuit check for directory name pattern match</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory_name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">match_pattern</span><span class="p">(</span><span class="n">dirpath</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory_name</span><span class="p">):</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> x Failed match on directory name: Expected: </span><span class="si">%s</span><span class="s2">, Found: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="n">lpad</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">directory_name</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="n">dirpath</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="c1"># Short circuit check for required file patterns</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="c1"># If all input filenames do not match a pattern, then its a missed pattern, and not a match</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="c1"># The failing case is when no files match a pattern, aka all files do not match.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="c1">#</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="c1"># NOTE(Performance): Use PatternMatcher to avoid FFI overhead on each filename check</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="c1"># PatternMatcher compiles the pattern once and keeps it in Rust, avoiding repeated FFI calls</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="c1"># Invalid patterns are automatically handled by PatternMatcher (falls back to Python)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">matcher</span> <span class="o">=</span> <span class="n">PatternMatcher</span><span class="p">([</span><span class="n">pattern</span><span class="p">])</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="k">if</span> <span class="n">_none_of</span><span class="p">(</span><span class="n">matcher</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">):</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> x Failed match on required file pattern. Required </span><span class="si">%s</span><span class="s2">, Found: </span><span class="si">%s</span><span class="s2">, Directory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>                <span class="n">lpad</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                <span class="n">pattern</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                <span class="n">filenames</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                <span class="n">dirpath</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="c1"># NOTE: This could be written as a double nested list comprehension that includes the</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="c1"># self.directories iterations as well, but its rather confusing to read, leaving that</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="c1"># as an outer for-loop is easier to read.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="c1">#</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="c1"># Recurse into required subdirectory branches (if they exist)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="k">for</span> <span class="n">branch_pattern</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">directories</span><span class="p">:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="c1"># Evaluate if any actual directories from dirnames match the given pattern</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="k">if</span> <span class="n">_none_of</span><span class="p">(</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="n">branch_pattern</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">iterdir</span><span class="p">(</span><span class="n">dirpath</span> <span class="o">/</span> <span class="n">directory</span><span class="p">),</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">dirnames</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="p">):</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> x Failed on subdirectory match. Required </span><span class="si">%s</span><span class="s2">, Found: </span><span class="si">%s</span><span class="s2">, Directory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                <span class="n">lpad</span><span class="p">,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>                <span class="n">branch_pattern</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>                <span class="n">dirnames</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>                <span class="n">dirpath</span><span class="p">,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>            <span class="p">)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="c1"># Passing all previous checks implies:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="c1"># 1. The directory_name matches or is not a requirement</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="c1"># 2. The required file patterns are matched</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="c1"># 3. The required directories are matched (recursively)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="c1"># In this case, this directory structure meets the requirements!</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> + Matched: </span><span class="si">%s</span><span class="s2"> on </span><span class="si">%s</span><span class="s2">!&quot;</span><span class="p">,</span> <span class="n">lpad</span><span class="p">,</span> <span class="n">dirpath</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.copy" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">copy</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">copy</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dryrun</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Copy all files and folders from inside source that match the file requirements patterns into the destination path.</p>
<p>Before:
Source:
source_dir/
    file1.txt
    nested/
        file2.txt</p>
<p>Destination:
dest_dir/</p>
<p>After:
Source:
source_dir/
    file1.txt
    nested/
        file2.txt</p>
<p>Destination:
dest_dir/
source_dir/
    file1.txt
    nested/
        file2.txt</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">destination</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="n">dryrun</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy all files and folders from inside source that match the file requirements patterns into the destination path.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    Before:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    Source:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    source_dir/</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        file1.txt</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        nested/</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            file2.txt</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    Destination:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    dest_dir/</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    After:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Source:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    source_dir/</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        file1.txt</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        nested/</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">            file2.txt</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    Destination:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    dest_dir/</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    source_dir/</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        file1.txt</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        nested/</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">            file2.txt</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">dryrun_pad</span> <span class="o">=</span> <span class="s2">&quot;(dryrun) &quot;</span> <span class="k">if</span> <span class="n">dryrun</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">dryrun</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="n">destination</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="c1"># Copy all files in this top level that match a required or optional file pattern</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="n">_</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">files</span> <span class="o">=</span> <span class="n">iterdir</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="c1"># Use PatternMatcher for efficient multi-pattern matching</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="n">file_matcher</span> <span class="o">=</span> <span class="n">PatternMatcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_files</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_files</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">source</span> <span class="o">/</span> <span class="n">file</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="s2">&quot;Checking file against patterns&quot;</span><span class="p">,</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">file</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_files</span><span class="p">},</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="k">if</span> <span class="n">file_matcher</span> <span class="ow">and</span> <span class="n">file_matcher</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found match&quot;</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">dryrun</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Beginning copy&quot;</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                <span class="n">target</span> <span class="o">=</span> <span class="n">destination</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                <span class="n">stream_copy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                    <span class="s2">&quot;Copied file&quot;</span><span class="p">,</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                    <span class="n">extra</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>                        <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>                        <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="n">destination</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>                    <span class="p">},</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                <span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="c1"># Recurse into any directories at this level that match a required or optional directory pattern</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">directories</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">source</span> <span class="o">/</span> <span class="n">directory</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="k">for</span> <span class="n">branch_pattern</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_directories</span><span class="p">:</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="k">if</span> <span class="n">branch_pattern</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">iterdir</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>                <span class="n">branch_pattern</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>                    <span class="n">path</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                    <span class="n">destination</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                    <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                    <span class="n">dryrun</span><span class="o">=</span><span class="n">dryrun</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                <span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Directory copied&quot;</span><span class="p">,</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="n">dryrun_pad</span><span class="p">,</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="n">extra</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="n">destination</span><span class="p">,</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="p">},</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pathvein.pattern.FileStructurePattern.threaded_copy" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">threaded_copy</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">threaded_copy</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dryrun</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Copy all files and folders from inside source that match the file requirements patterns into the destination path.</p>
<p>Before:
Source:
source_dir/
    file1.txt
    nested/
        file2.txt</p>
<p>Destination:
dest_dir/</p>
<p>After:
Source:
source_dir/
    file1.txt
    nested/
        file2.txt</p>
<p>Destination:
dest_dir/
source_dir/
    file1.txt
    nested/
        file2.txt</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pathvein/pattern.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="k">def</span><span class="w"> </span><span class="nf">threaded_copy</span><span class="p">(</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="n">destination</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="n">dryrun</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy all files and folders from inside source that match the file requirements patterns into the destination path.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">    Before:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">    Source:</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">    source_dir/</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        file1.txt</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        nested/</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            file2.txt</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    Destination:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">    dest_dir/</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    After:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">    Source:</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    source_dir/</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        file1.txt</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        nested/</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            file2.txt</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">    Destination:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">    dest_dir/</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">    source_dir/</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        file1.txt</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        nested/</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">            file2.txt</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="n">futures</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Future</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>  <span class="c1"># Adjust based on your needs</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">recursive_scan</span><span class="p">(</span><span class="n">src</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">dest</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span> <span class="n">Self</span> <span class="o">=</span> <span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">dryrun</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                <span class="n">dest</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>            <span class="c1"># Copy all files in this top level that match a required or optional file pattern</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>            <span class="n">_</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">files</span> <span class="o">=</span> <span class="n">iterdir</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>            <span class="c1"># Use PatternMatcher for efficient multi-pattern matching</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="n">file_matcher</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                <span class="n">PatternMatcher</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">all_files</span><span class="p">)</span> <span class="k">if</span> <span class="n">pattern</span><span class="o">.</span><span class="n">all_files</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                <span class="s2">&quot;Beginning copy operation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                <span class="n">extra</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">src</span><span class="p">,</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                    <span class="s2">&quot;directories&quot;</span><span class="p">:</span> <span class="n">directories</span><span class="p">,</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="n">files</span><span class="p">,</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                    <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="n">pattern</span><span class="p">,</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                <span class="p">},</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>            <span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                <span class="n">path</span> <span class="o">=</span> <span class="n">src</span> <span class="o">/</span> <span class="n">file</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                    <span class="s2">&quot;Checking file against patterns&quot;</span><span class="p">,</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                    <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="n">pattern</span><span class="o">.</span><span class="n">all_files</span><span class="p">},</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                <span class="p">)</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                <span class="k">if</span> <span class="n">file_matcher</span> <span class="ow">and</span> <span class="n">file_matcher</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found match&quot;</span><span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">dryrun</span><span class="p">:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>                        <span class="n">target</span> <span class="o">=</span> <span class="n">dest</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>                            <span class="s2">&quot;Submitting copy task&quot;</span><span class="p">,</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                            <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span> <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">},</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                        <span class="p">)</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                        <span class="n">future</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">stream_copy</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                        <span class="n">futures</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>            <span class="c1"># Recurse into any directories at this level that match a required or optional directory pattern</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">directories</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                <span class="n">path</span> <span class="o">=</span> <span class="n">src</span> <span class="o">/</span> <span class="n">directory</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                <span class="k">for</span> <span class="n">branch_pattern</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_directories</span><span class="p">:</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                    <span class="k">if</span> <span class="n">branch_pattern</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">iterdir</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                        <span class="n">recursive_scan</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dest</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">branch_pattern</span><span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">recursive_scan</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Waiting for futures&quot;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">futures</span><span class="p">)})</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="n">done</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">wait</span><span class="p">(</span><span class="n">futures</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Copy operation failed&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Directory copied&quot;</span><span class="p">,</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="s2">&quot;(dryrun) &quot;</span> <span class="k">if</span> <span class="n">dryrun</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="n">extra</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="n">destination</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="p">},</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="usage-examples">Usage Examples</h2>
<h3 id="creating-patterns">Creating Patterns</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathvein</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileStructurePattern</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># Constructor</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;experiment_*&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;data.csv&quot;</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">optional_files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;notes.txt&quot;</span><span class="p">]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># Builder pattern</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">pattern</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">FileStructurePattern</span><span class="p">()</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="o">.</span><span class="n">set_directory_name</span><span class="p">(</span><span class="s2">&quot;exp_*&quot;</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="o">.</span><span class="n">add_files</span><span class="p">([</span><span class="s2">&quot;data.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;results.csv&quot;</span><span class="p">])</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="s2">&quot;notes.txt&quot;</span><span class="p">,</span> <span class="n">is_optional</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="p">)</span>
</code></pre></div>
<h3 id="nested-patterns">Nested Patterns</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">src_pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;src&quot;</span><span class="p">,</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;__init__.py&quot;</span><span class="p">]</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">project_pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="p">(</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;my_project&quot;</span><span class="p">,</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;README.md&quot;</span><span class="p">],</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="n">directories</span><span class="o">=</span><span class="p">[</span><span class="n">src_pattern</span><span class="p">]</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="p">)</span>
</code></pre></div>
<h3 id="json-serialization">JSON Serialization</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c1"># Save</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">json_str</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;pattern.json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c1"># Load from file</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;pattern.json&quot;</span><span class="p">))</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="c1"># Load from string</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="n">pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
</code></pre></div>
<h3 id="pattern-matching">Pattern Matching</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathvein._path_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">iterdir</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;data/experiment_001&quot;</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="o">=</span> <span class="n">iterdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="k">if</span> <span class="n">pattern</span><span class="o">.</span><span class="n">matches</span><span class="p">((</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span><span class="p">)):</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Match!&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="finding-parent-directories">Finding Parent Directories</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;data/experiment_001/results.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="n">candidates</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">parents_of</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Possible root: </span><span class="si">{</span><span class="n">candidate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="copying-with-patterns">Copying with Patterns</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1"># Single-threaded copy</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">pattern</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="n">source</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;data/exp_001&quot;</span><span class="p">),</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>    <span class="n">destination</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;backup/exp_001&quot;</span><span class="p">),</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="n">dryrun</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="p">)</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="c1"># Multi-threaded copy (faster for many small files)</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="n">pattern</span><span class="o">.</span><span class="n">threaded_copy</span><span class="p">(</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>    <span class="n">source</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;data/exp_001&quot;</span><span class="p">),</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>    <span class="n">destination</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;backup/exp_001&quot;</span><span class="p">),</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>    <span class="n">dryrun</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>    <span class="n">max_workers</span><span class="o">=</span><span class="mi">4</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="p">)</span>
</code></pre></div>
<h2 id="pattern-components">Pattern Components</h2>
<h3 id="directory_name">directory_name</h3>
<p>Glob pattern for the directory name. Default: <code>"*"</code> (matches any name)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># Match exact name</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="p">(</span><span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;src&quot;</span><span class="p">)</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c1"># Match with wildcard</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="p">(</span><span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;experiment_*&quot;</span><span class="p">)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c1"># Match any name</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="p">(</span><span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="files">files</h3>
<p>List of required file patterns. At least one file must match each pattern.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="p">(</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;config.yaml&quot;</span><span class="p">]</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="p">)</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># Requires: at least one .csv file AND config.yaml</span>
</code></pre></div>
<h3 id="directories">directories</h3>
<p>List of required subdirectory patterns. At least one directory must match each pattern.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="p">(</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    <span class="n">directories</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>        <span class="n">FileStructurePattern</span><span class="p">(</span><span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">),</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>        <span class="n">FileStructurePattern</span><span class="p">(</span><span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;models&quot;</span><span class="p">)</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="p">]</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="p">)</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c1"># Requires: at least one &quot;data&quot; directory AND at least one &quot;models&quot; directory</span>
</code></pre></div>
<h3 id="optional_files">optional_files</h3>
<p>List of optional file patterns. Not required for a match.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="p">(</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">],</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="n">optional_files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;notes.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;debug.log&quot;</span><span class="p">]</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="p">)</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="c1"># Requires config.yaml, but notes.txt and debug.log are optional</span>
</code></pre></div>
<h3 id="optional_directories">optional_directories</h3>
<p>List of optional subdirectory patterns. Not required for a match.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">pattern</span> <span class="o">=</span> <span class="n">FileStructurePattern</span><span class="p">(</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">directories</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>        <span class="n">FileStructurePattern</span><span class="p">(</span><span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;src&quot;</span><span class="p">)</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="p">],</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="n">optional_directories</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>        <span class="n">FileStructurePattern</span><span class="p">(</span><span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;docs&quot;</span><span class="p">),</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>        <span class="n">FileStructurePattern</span><span class="p">(</span><span class="n">directory_name</span><span class="o">=</span><span class="s2">&quot;tests&quot;</span><span class="p">)</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="p">]</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="p">)</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="c1"># Requires src/, but docs/ and tests/ are optional</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>